<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Next steps • growthcleanr</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Next steps">
<meta property="og:description" content="growthcleanr">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">growthcleanr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="divider">
    </li>
<li class="dropdown-header">Getting started</li>
    <li>
      <a href="../articles/quickstart.html">Quickstart</a>
    </li>
    <li>
      <a href="../articles/installation.html">Installation</a>
    </li>
    <li>
      <a href="../articles/usage.html">Usage</a>
    </li>
    <li class="divider">
    </li>
<li class="dropdown-header">Advanced topics</li>
    <li>
      <a href="../articles/configuration.html">Configuration</a>
    </li>
    <li>
      <a href="../articles/output.html">Understanding growthcleanr output</a>
    </li>
    <li>
      <a href="../articles/adult-algorithm.html">Adult algorithm</a>
    </li>
    <li>
      <a href="../articles/utilities.html">Utilities for computing pediatric BMI percentiles, Z-scores, and related tools</a>
    </li>
    <li>
      <a href="../articles/large-data-sets.html">Working with large data sets</a>
    </li>
    <li>
      <a href="../articles/next-steps.html">Next steps</a>
    </li>
    <li>
      <a href="../articles/developer-guidelines.html">Developer guidelines</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/carriedaymont/growthcleanr" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Next steps</h1>
            
            <h4 data-toc-skip class="date">2023-03-01</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/carriedaymont/growthcleanr/blob/main/vignettes/next-steps.Rmd" class="external-link"><code>vignettes/next-steps.Rmd</code></a></small>
      <div class="hidden name"><code>next-steps.Rmd</code></div>

    </div>

    
    
<p>While both the pediatric and adult algorithms are considered
complete, we have identified several areas for additional research and
potential enhancement.</p>
<div class="section level2">
<h2 id="pediatric-algorithm---carried-forward-adjustments">Pediatric algorithm - carried forward adjustments<a class="anchor" aria-label="anchor" href="#pediatric-algorithm---carried-forward-adjustments"></a>
</h2>
<p>An experiment in re-assessing pediatric height measurements initially
marked as <code>Exclude-Carried-Forward</code> based on growth velocity
is included in the current version of this package.</p>
<p>Because of the complexity involved in this approach, this is
implemented as an independent function with its own driver script for
further study. Our hope is to revise this strategy, and, if feasible,
incorporate it into the main <code><a href="../reference/cleangrowth.html">cleangrowth()</a></code> algorithm.</p>
<div class="section level3">
<h3 id="running-the-experiment">Running the experiment<a class="anchor" aria-label="anchor" href="#running-the-experiment"></a>
</h3>
<p>The primary function is called <code><a href="../reference/adjustcarryforward.html">adjustcarryforward()</a></code>, and
is implemented in the file <code>R/adjustcarryforward.R</code>. It is
separate from the main <code>R/growth.R</code> file as it is set up to
be run separately, using the output from <code><a href="../reference/cleangrowth.html">cleangrowth()</a></code>. The
<code><a href="../reference/adjustcarryforward.html">adjustcarryforward()</a></code> function is available in the main
package namespace.</p>
<p>The primary tools for running this function are the script
<code>exec/testadjustcf.R</code> and the function
<code><a href="../reference/testacf.html">testacf()</a></code>. These will run the experimental function on an
existing dataset (specified as a CSV file or data frame) and pass it a
sweep of parameter values for testing the new strategy. This tool will
produce a combined output file or list that includes the original result
alongside the resulting re-inclusion determination for each measurement
for each parameter value run.</p>
<p>For example, if you have run <code><a href="../reference/cleangrowth.html">cleangrowth()</a></code> on the
<code>syngrowth</code> synthetic data set provided with
<code>growthcleanr</code> as described in the main
<code>README.md</code> file, save it to a CSV file for
<code>exec/testadjustcf.R</code>:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">fwrite</span>(cleaned_data, <span class="st">"cleaned.csv"</span>, <span class="at">row.names =</span> F)</span></code></pre></div>
<p>For <code><a href="../reference/testacf.html">testacf()</a></code>, keep cleaned_data in your environment.
Note that the column names should be as described for
<code>cleaned_data</code> the Example under Quickstart.</p>
<p>To use <code>exec/testadjustcf.R</code>, first navigate to the
growthcleanr package directory in the command line. Then execute the
sweep script is executed from the command line on the cleaned data file
for as follows (with the assumption that cleaned.csv is in your current
directory; otherwise, make sure to specify the path relative to your
current directory):</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="ex">%</span> Rscript exec/testadjustcf.R cleaned.csv</span></code></pre></div>
<p>To use <code><a href="../reference/testacf.html">testacf()</a></code>, run the following in the console (with
<code>cleaned_data</code> in the environment):</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/testacf.html">testacf</a></span><span class="op">(</span><span class="va">cleaned_data</span><span class="op">)</span></span></code></pre></div>
<p>This <code>result_list</code> will contain 2 or 3 objects; -
<code>testacf_res</code>: a data frame with adjustcarryforward results
for each run - <code>params</code>: a data frame containing the
parameters for each run - <code>debug_filtered_data</code>: data frame
with original data, returned if debug is <code>TRUE</code></p>
<p>By default, the script/function will generate a range of values with
nine steps for the following parameters, where the min and max surround
the default value:</p>
<table class="table">
<thead><tr class="header">
<th>parameter</th>
<th>default</th>
<th>min</th>
<th>max</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>minfactor</code></td>
<td>0.5</td>
<td>0</td>
<td>1</td>
</tr>
<tr class="even">
<td><code>maxfactor</code></td>
<td>2</td>
<td>0</td>
<td>4</td>
</tr>
<tr class="odd">
<td><code>banddiff</code></td>
<td>3</td>
<td>0</td>
<td>6</td>
</tr>
<tr class="even">
<td><code>banddiff_plus</code></td>
<td>5.5</td>
<td>0</td>
<td>11</td>
</tr>
<tr class="odd">
<td><code>min_ht.exp_under</code></td>
<td>2</td>
<td>0</td>
<td>4</td>
</tr>
<tr class="even">
<td><code>min_ht.exp_over</code></td>
<td>0</td>
<td>-1</td>
<td>1</td>
</tr>
<tr class="odd">
<td><code>max_ht.exp_under</code></td>
<td>0.33</td>
<td>0</td>
<td>0.66</td>
</tr>
<tr class="even">
<td><code>max_ht.exp_over</code></td>
<td>1.5</td>
<td>0</td>
<td>3</td>
</tr>
</tbody>
</table>
<p>The determination of these values depends on the search type
(specified with the option <code>--searchtype</code> (script)/argument
<code>searchtype</code> (function):</p>
<ul>
<li>
<p><code>random</code> (default): Values will be generated randomly,
with equal amounts of values on either side of the midpoint. The
midpoint is always included.</p>
<ul>
<li>Note that if an even number is specified for
<code>--gridlength</code>/<code>grid.length</code>, one will be added to
include the midpoint in the run.</li>
<li>A random seed can be specified with
<code>--seed</code>/<code>seed</code> (default 7).</li>
</ul>
</li>
<li><p><code>line-grid</code>: Values will be evenly distributed along
the range for each parameter. If the
<code>--gridlength</code>/<code>grid.length</code> specified is odd,
this will include the midpoint.</p></li>
<li>
<p><code>full-grid</code>: Values for each included parameter will
evenly distributed along the range for each parameter and in a full
combination between all parameters.</p>
<ul>
<li>Thus, the amount of runs done will be the
<code>--gridlength</code>/<code>gridlength</code>^(number of included
parameters).</li>
<li>Default includes a full grid search among all parameters. To specify
use of only specific parameters, use the
<code>--param</code>/<code>param</code> option, which specifies a CSV of
the following format:</li>
</ul>
<table class="table">
<thead><tr class="header">
<th>parameter</th>
<th>include</th>
<th>value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>minfactor</code></td>
<td>T</td>
<td></td>
</tr>
<tr class="even">
<td><code>maxfactor</code></td>
<td>F</td>
<td>3</td>
</tr>
<tr class="odd">
<td><code>banddiff</code></td>
<td>F</td>
<td></td>
</tr>
<tr class="even">
<td><code>banddiff_plus</code></td>
<td>F</td>
<td></td>
</tr>
<tr class="odd">
<td><code>min_ht.exp_under</code></td>
<td>T</td>
<td></td>
</tr>
<tr class="even">
<td><code>min_ht.exp_over</code></td>
<td>F</td>
<td></td>
</tr>
<tr class="odd">
<td><code>max_ht.exp_under</code></td>
<td>F</td>
<td>.5</td>
</tr>
<tr class="even">
<td><code>max_ht.exp_over</code></td>
<td>F</td>
<td></td>
</tr>
</tbody>
</table>
<ul>
<li>The first column specifies all the parameter names; the second
specifies a true or false value for whether or not the parameter should
be included; the third specifies a constant value to be used for not
included parameters, left empty if the value should be the default.</li>
<li>In the above example, <code>minfactor</code> and
<code>min_ht.exp_under</code> will be included, and
<code>maxfactor</code> and <code>max_ht_exp_under</code> will not be
included, but will use 3 and .5 as their values.</li>
<li>Warning: this will take much longer!</li>
</ul>
</li>
</ul>
<p>The default number of sweep steps is 9; this can be changed with the
option <code>--gridlength</code>/<code>gridlength</code>.</p>
<p>For testing options of handling strings of multiple carried forward
values, several options from 0 to 3 have been incorporated. 0 (no
change) is the default option, and can be changed
<code>--exclude_opt</code>/<code>exclude_opt</code>. More information on
each option can be found in the <code><a href="../reference/adjustcarryforward.html">adjustcarryforward()</a></code>
documentation.</p>
<p>In addition to multiple options for carried-forward strings,
“answers” for a given dataset have been incorporated. When the
<code>--add_answers</code> flag/<code>add_answers</code> argument is set
to <code>TRUE</code> (<code>TRUE</code> by default), a column called
<code>acf_answers</code> will have, for each height value, “Definitely
Exclude”, “Definitely Include”, or “Unknown” (if it does not fall in
either category). Weight values are set as <code>NA</code>.</p>
<p>For example, for a 9-step sweep with the default search type,
<code>random</code>, the parameters passed to the function in each pass
will be:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>run minfactor   maxfactor   banddiff    banddiff_plus   min_ht.exp_under    min_ht.exp_over max_ht.exp_under    max_ht.exp_over</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>   <span class="fl">0.494454649</span> <span class="fl">0.331710969</span> <span class="fl">1.681997601</span> <span class="fl">5.438065292</span> <span class="fl">0.371428523</span> <span class="sc">-</span><span class="fl">0.200524185</span>    <span class="fl">0.296497153</span> <span class="fl">0.244186167</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>   <span class="fl">0.198872727</span> <span class="fl">0.918207332</span> <span class="fl">0.0261138</span>   <span class="fl">0.361051567</span> <span class="fl">0.370286443</span> <span class="sc">-</span><span class="fl">0.618056939</span>    <span class="fl">0.318943811</span> <span class="fl">0.280842425</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>   <span class="fl">0.057848889</span> <span class="fl">0.343496154</span> <span class="fl">2.957211272</span> <span class="fl">3.448713172</span> <span class="fl">0.758593493</span> <span class="sc">-</span><span class="fl">0.240298769</span>    <span class="fl">0.189112731</span> <span class="fl">0.586874211</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>   <span class="fl">0.034874339</span> <span class="fl">0.462954204</span> <span class="fl">0.949754412</span> <span class="fl">2.697612725</span> <span class="fl">1.694048784</span> <span class="sc">-</span><span class="fl">0.563224398</span>    <span class="fl">0.237626234</span> <span class="fl">0.410851815</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span>   <span class="fl">0.5</span> <span class="dv">2</span>   <span class="dv">3</span>   <span class="fl">5.5</span> <span class="dv">2</span>   <span class="dv">0</span>   <span class="fl">0.33</span>    <span class="fl">1.5</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span>   <span class="fl">0.621874695</span> <span class="fl">3.545623892</span> <span class="fl">4.918346826</span> <span class="fl">10.84063427</span> <span class="fl">2.996152267</span> <span class="fl">0.904217721</span> <span class="fl">0.585439346</span> <span class="fl">1.787876622</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="dv">7</span>   <span class="fl">0.896005213</span> <span class="fl">2.192603083</span> <span class="fl">3.885669706</span> <span class="fl">7.492214661</span> <span class="fl">3.581171147</span> <span class="fl">0.319534914</span> <span class="fl">0.537161064</span> <span class="fl">2.25658771</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="dv">8</span>   <span class="fl">0.670031176</span> <span class="fl">2.90689554</span>  <span class="fl">5.990111082</span> <span class="fl">9.239964036</span> <span class="fl">3.676927744</span> <span class="fl">0.082569093</span> <span class="fl">0.568586483</span> <span class="fl">2.645760535</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="dv">9</span>   <span class="fl">0.98603125</span>  <span class="fl">2.169401426</span> <span class="fl">5.718063961</span> <span class="fl">6.950459617</span> <span class="fl">2.91380773</span>  <span class="fl">0.816289079</span> <span class="fl">0.457654322</span> <span class="fl">2.540503306</span></span></code></pre></div>
<p>In a 9-step sweep with a <code>line-grid</code> search type, the
parameters passed to the function in each pass will be:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>run  minfactor  maxfactor  banddiff  banddiff_plus  min_ht.exp_under  min_ht.exp_over  max_ht.exp_under  max_ht.exp_over</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>    <span class="dv">0</span>          <span class="dv">0</span>          <span class="dv">0</span>         <span class="dv">0</span>              <span class="dv">0</span>                 <span class="sc">-</span><span class="dv">1</span>               <span class="dv">0</span>                 <span class="dv">0</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>    <span class="fl">0.125</span>      <span class="fl">0.5</span>        <span class="fl">0.75</span>      <span class="fl">1.375</span>          <span class="fl">0.5</span>               <span class="sc">-</span><span class="fl">0.75</span>            <span class="fl">0.0825</span>            <span class="fl">0.375</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>    <span class="fl">0.25</span>       <span class="dv">1</span>          <span class="fl">1.5</span>       <span class="fl">2.75</span>           <span class="dv">1</span>                 <span class="sc">-</span><span class="fl">0.5</span>             <span class="fl">0.165</span>             <span class="fl">0.75</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>    <span class="fl">0.375</span>      <span class="fl">1.5</span>        <span class="fl">2.25</span>      <span class="fl">4.125</span>          <span class="fl">1.5</span>               <span class="sc">-</span><span class="fl">0.25</span>            <span class="fl">0.2475</span>            <span class="fl">1.125</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span>    <span class="fl">0.5</span>        <span class="dv">2</span>          <span class="dv">3</span>         <span class="fl">5.5</span>            <span class="dv">2</span>                 <span class="dv">0</span>                <span class="fl">0.33</span>              <span class="fl">1.5</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span>    <span class="fl">0.625</span>      <span class="fl">2.5</span>        <span class="fl">3.75</span>      <span class="fl">6.875</span>          <span class="fl">2.5</span>               <span class="fl">0.25</span>             <span class="fl">0.4125</span>            <span class="fl">1.875</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="dv">7</span>    <span class="fl">0.75</span>       <span class="dv">3</span>          <span class="fl">4.5</span>       <span class="fl">8.25</span>           <span class="dv">3</span>                 <span class="fl">0.5</span>              <span class="fl">0.495</span>             <span class="fl">2.25</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="dv">8</span>    <span class="fl">0.875</span>      <span class="fl">3.5</span>        <span class="fl">5.25</span>      <span class="fl">9.625</span>          <span class="fl">3.5</span>               <span class="fl">0.75</span>             <span class="fl">0.5775</span>            <span class="fl">2.625</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="dv">9</span>    <span class="dv">1</span>          <span class="dv">4</span>          <span class="dv">6</span>         <span class="dv">11</span>             <span class="dv">4</span>                 <span class="dv">1</span>                <span class="fl">0.66</span>              <span class="dv">3</span></span></code></pre></div>
<p>In a 3-step sweep with a <code>full-grid</code> search type, with the
<code>--param</code> CSV/<code>param</code> data frame specified as in
the above example, the parameters passed to the function in each pass
will be:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>run minfactor maxfactor banddiff banddiff_plus min_ht.exp_under min_ht.exp_over max_ht.exp_under max_ht.exp_over</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>       <span class="fl">0.0</span>         <span class="dv">3</span>        <span class="dv">3</span>           <span class="fl">5.5</span>                <span class="dv">0</span>               <span class="dv">0</span>              <span class="fl">0.5</span>             <span class="fl">1.5</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>       <span class="fl">0.5</span>         <span class="dv">3</span>        <span class="dv">3</span>           <span class="fl">5.5</span>                <span class="dv">0</span>               <span class="dv">0</span>              <span class="fl">0.5</span>             <span class="fl">1.5</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>       <span class="fl">1.0</span>         <span class="dv">3</span>        <span class="dv">3</span>           <span class="fl">5.5</span>                <span class="dv">0</span>               <span class="dv">0</span>              <span class="fl">0.5</span>             <span class="fl">1.5</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>       <span class="fl">0.0</span>         <span class="dv">3</span>        <span class="dv">3</span>           <span class="fl">5.5</span>                <span class="dv">2</span>               <span class="dv">0</span>              <span class="fl">0.5</span>             <span class="fl">1.5</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span>       <span class="fl">0.5</span>         <span class="dv">3</span>        <span class="dv">3</span>           <span class="fl">5.5</span>                <span class="dv">2</span>               <span class="dv">0</span>              <span class="fl">0.5</span>             <span class="fl">1.5</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span>       <span class="fl">1.0</span>         <span class="dv">3</span>        <span class="dv">3</span>           <span class="fl">5.5</span>                <span class="dv">2</span>               <span class="dv">0</span>              <span class="fl">0.5</span>             <span class="fl">1.5</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="dv">7</span>       <span class="fl">0.0</span>         <span class="dv">3</span>        <span class="dv">3</span>           <span class="fl">5.5</span>                <span class="dv">4</span>               <span class="dv">0</span>              <span class="fl">0.5</span>             <span class="fl">1.5</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="dv">8</span>       <span class="fl">0.5</span>         <span class="dv">3</span>        <span class="dv">3</span>           <span class="fl">5.5</span>                <span class="dv">4</span>               <span class="dv">0</span>              <span class="fl">0.5</span>             <span class="fl">1.5</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="dv">9</span>       <span class="fl">1.0</span>         <span class="dv">3</span>        <span class="dv">3</span>           <span class="fl">5.5</span>                <span class="dv">4</span>               <span class="dv">0</span>              <span class="fl">0.5</span>             <span class="fl">1.5</span></span></code></pre></div>
<p>For the script, the output in the working directory will contain the
sweep parameters, like the above, in a file called
<code>test_adjustcarrforward_DATE_TIME_parameters.csv</code>, and the
output with adjustment results in a file called
<code>test_adjustcarrforward_DATE_TIME.csv</code>, where DATE and TIME
are the system date and time. For the function, a list will be returned
with the parameters as a data.frame in the <code>params</code> entry and
output adjustment results as a data.frame in the
<code>testacf_res</code> entry.</p>
<p>For example, a 5-step sweep with the <code>line-grid</code> search
would be run with this command:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="ex">%</span> Rscript exec/textadjustcf.R <span class="at">--gridlength</span> 5 <span class="at">--searchtype</span> line-grid cleaned.csv</span></code></pre></div>
<p>or with this function execution:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/testacf.html">testacf</a></span><span class="op">(</span></span>
<span>  <span class="va">cleaned_data</span>,</span>
<span>  grid.length <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  searchtype <span class="op">=</span> <span class="st">"line-grid"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The parameter set for the sweep in file
<code>test_adjustcarrforward_DATE_TIME_parameters.csv</code>
(script)/<code>params</code> data frame of <code>result_list</code>
(function) would be:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>run  minfactor  maxfactor  banddiff  banddiff_plus  min_ht.exp_under  min_ht.exp_over  max_ht.exp_under  max_ht.exp_over</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>    <span class="dv">0</span>          <span class="dv">0</span>          <span class="dv">0</span>         <span class="dv">0</span>              <span class="dv">0</span>                 <span class="sc">-</span><span class="dv">1</span>               <span class="dv">0</span>                 <span class="dv">0</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>    <span class="fl">0.25</span>       <span class="dv">1</span>          <span class="fl">1.5</span>       <span class="fl">2.75</span>           <span class="dv">1</span>                 <span class="sc">-</span><span class="fl">0.5</span>             <span class="fl">0.165</span>             <span class="fl">0.75</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>    <span class="fl">0.5</span>        <span class="dv">2</span>          <span class="dv">3</span>         <span class="fl">5.5</span>            <span class="dv">2</span>                 <span class="dv">0</span>                <span class="fl">0.33</span>              <span class="fl">1.5</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>    <span class="fl">0.75</span>       <span class="dv">3</span>          <span class="fl">4.5</span>       <span class="fl">8.25</span>           <span class="dv">3</span>                 <span class="fl">0.5</span>              <span class="fl">0.495</span>             <span class="fl">2.25</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span>    <span class="dv">1</span>          <span class="dv">4</span>          <span class="dv">6</span>         <span class="dv">11</span>             <span class="dv">4</span>                 <span class="dv">1</span>                <span class="fl">0.66</span>              <span class="dv">3</span></span></code></pre></div>
<p>Note that an odd-numbered length will include the default values in
the middle run of the sweep (hence the examples with 5 and 9 step
sweeps).</p>
<p>And the first few result rows in
<code>test_adjustcarrforward_DATE_TIME.csv</code>
(script)/<code>testacf_res</code> data frame of <code>result_list</code>
(function) would be:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>id     subjid    sex  agedays  param     measurement  gcr_result                      run<span class="dv">-1</span>      run<span class="dv">-2</span>      run<span class="dv">-3</span>      run<span class="dv">-4</span>      run<span class="dv">-5</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="dv">1510</span>   <span class="dv">775155</span>    <span class="dv">0</span>    <span class="dv">889</span>      HEIGHTCM  <span class="fl">84.9</span>         Exclude<span class="sc">-</span>Extraneous<span class="sc">-</span>Same<span class="sc">-</span>Day Missing    Missing    Missing    Missing    Missing</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="dv">1511</span>   <span class="dv">775155</span>    <span class="dv">0</span>    <span class="dv">889</span>      HEIGHTCM  <span class="fl">89.06</span>        Include                     No Change  No Change  No Change  No Change  No Change</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="dv">1512</span>   <span class="dv">775155</span>    <span class="dv">0</span>    <span class="dv">1071</span>     HEIGHTCM  <span class="fl">92.5</span>         Include                     No Change  No Change  No Change  No Change  No Change</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="dv">1513</span>   <span class="dv">775155</span>    <span class="dv">0</span>    <span class="dv">1253</span>     HEIGHTCM  <span class="fl">96.2</span>         Include                     No Change  No Change  No Change  No Change  No Change</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="dv">1514</span>   <span class="dv">775155</span>    <span class="dv">0</span>    <span class="dv">1435</span>     HEIGHTCM  <span class="fl">96.2</span>         Exclude<span class="sc">-</span>Carried<span class="sc">-</span>Forward     No Change  No Change  Include    Include    Include</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="dv">1515</span>   <span class="dv">775155</span>    <span class="dv">0</span>    <span class="dv">1435</span>     HEIGHTCM  <span class="fl">99.692</span>       Include                     No Change  No Change  No Change  No Change  No Change</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="dv">1516</span>   <span class="dv">775155</span>    <span class="dv">0</span>    <span class="dv">1806</span>     HEIGHTCM  <span class="fl">106.1</span>        Include                     No Change  No Change  No Change  No Change  No Change</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="dv">1517</span>   <span class="dv">775155</span>    <span class="dv">0</span>    <span class="dv">2177</span>     HEIGHTCM  <span class="fl">112.3</span>        Include                     No Change  No Change  No Change  No Change  No Change</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="dv">1518</span>   <span class="dv">775155</span>    <span class="dv">0</span>    <span class="dv">889</span>      WEIGHTKG  <span class="fl">13.1</span>         Include                     No Change  No Change  No Change  No Change  No Change</span></code></pre></div>
<p>The fifth row in the example above demonstrates the results of the
experimental script; for runs 1 and 2, the result is not changed, but
for runs 3-5, the measurement is adjusted for reinclusion. To
demonstrate the range, the following is an extract of measurements only
marked as carried forward exclusions by <code><a href="../reference/cleangrowth.html">cleangrowth()</a></code>:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>id     subjid     sex  agedays  param     measurement  gcr_result                   run<span class="dv">-1</span>      run<span class="dv">-2</span>      run<span class="dv">-3</span>      run<span class="dv">-4</span>      run<span class="dv">-5</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="dv">1514</span>   <span class="dv">775155</span>     <span class="dv">0</span>    <span class="dv">1435</span>     HEIGHTCM  <span class="fl">96.2</span>         Exclude<span class="sc">-</span>Carried<span class="sc">-</span>Forward  No Change  No Change  Include    Include    Include</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="dv">1521</span>   <span class="dv">775155</span>     <span class="dv">0</span>    <span class="dv">1435</span>     WEIGHTKG  <span class="fl">15.3</span>         Exclude<span class="sc">-</span>Carried<span class="sc">-</span>Forward  No Change  No Change  No Change  No Change  No Change</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="dv">7952</span>   <span class="dv">1340377</span>    <span class="dv">1</span>    <span class="dv">1806</span>     HEIGHTCM  <span class="fl">107.1</span>        Exclude<span class="sc">-</span>Carried<span class="sc">-</span>Forward  No Change  Include    Include    Include    Include</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="dv">7967</span>   <span class="dv">1340377</span>    <span class="dv">1</span>    <span class="dv">1806</span>     WEIGHTKG  <span class="fl">18.4</span>         Exclude<span class="sc">-</span>Carried<span class="sc">-</span>Forward  No Change  No Change  No Change  No Change  No Change</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="dv">41775</span>  <span class="dv">3643526</span>    <span class="dv">1</span>    <span class="dv">1253</span>     HEIGHTCM  <span class="fl">87.808</span>       Exclude<span class="sc">-</span>Carried<span class="sc">-</span>Forward  Include    Include    Include    Include    Include</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="dv">44901</span>  <span class="dv">3706097</span>    <span class="dv">0</span>    <span class="dv">4032</span>     HEIGHTCM  <span class="fl">138.8</span>        Exclude<span class="sc">-</span>Carried<span class="sc">-</span>Forward  No Change  Include    Include    Include    Include</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="dv">30011</span>  <span class="dv">5792371</span>    <span class="dv">1</span>    <span class="dv">3661</span>     HEIGHTCM  <span class="fl">145.4</span>        Exclude<span class="sc">-</span>Carried<span class="sc">-</span>Forward  No Change  Include    Include    Include    Include</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="dv">30013</span>  <span class="dv">5792371</span>    <span class="dv">1</span>    <span class="dv">4032</span>     HEIGHTCM  <span class="fl">145.4</span>        Exclude<span class="sc">-</span>Carried<span class="sc">-</span>Forward  No Change  No Change  No Change  No Change  No Change</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="dv">30016</span>  <span class="dv">5792371</span>    <span class="dv">1</span>    <span class="dv">1071</span>     WEIGHTKG  <span class="fl">15.9</span>         Exclude<span class="sc">-</span>Carried<span class="sc">-</span>Forward  No Change  No Change  No Change  No Change  No Change</span></code></pre></div>
<p>Some of these values are not adjusted at all; one is from run 1 on, a
few are from run 2 on, and one is from run 3 on.</p>
</div>
</div>
<div class="section level2">
<h2 id="adult-algorithm---potential-enhancements">Adult algorithm - potential enhancements<a class="anchor" aria-label="anchor" href="#adult-algorithm---potential-enhancements"></a>
</h2>
<p>The <a href="adult-algorithm.html">adult algorithm</a> added in
release 2.0 is complete, but has some known limitations that present
areas for future research and enhancement. These areas are enumerated
below.</p>
<p>We welcome your ideas on these or any additional enhancements via
email, tickets, or pull requests.</p>
<p>Any active work on these areas will be ticketed and managed through
GitHub.</p>
<div class="section level3">
<h3 id="evil-twins">“Evil twins”<a class="anchor" aria-label="anchor" href="#evil-twins"></a>
</h3>
<p>In some cases, runs of two or three similar - but not necessarily
identical - deviant weights can occur, which are difficult to detect.
One approach to address these could involve modifying the moderate EWMA
step, but capturing these reliably may be a very challenging task.</p>
</div>
<div class="section level3">
<h3 id="moderate-ewma-adjustments">Moderate EWMA adjustments<a class="anchor" aria-label="anchor" href="#moderate-ewma-adjustments"></a>
</h3>
<p>A number of adjustments are possible to improve this step, such as
tweaks to the weight change allowance, polation, and prioritization.
This might require fewer changes to code but more extensive testing to
ensure confidence in new threshold numbers/details.</p>
</div>
<div class="section level3">
<h3 id="loosen-criteria-on-hundreds-unit-errors-etc-">Loosen criteria on hundreds, unit errors, etc.<a class="anchor" aria-label="anchor" href="#loosen-criteria-on-hundreds-unit-errors-etc-"></a>
</h3>
<p>The criteria for some of these steps may be loosened to catch more
implausible values. For unit error correction, we could consider having
two levels: one suitable for correction, the other not.</p>
</div>
<div class="section level3">
<h3 id="number-of-height-loss-events">Number of height loss events<a class="anchor" aria-label="anchor" href="#number-of-height-loss-events"></a>
</h3>
<p>While maintaining overall height loss limits, we could allow for the
possibility of more height loss events rather than assuming height loss
will occur in no more than two big jumps.</p>
</div>
<div class="section level3">
<h3 id="error-load">Error load<a class="anchor" aria-label="anchor" href="#error-load"></a>
</h3>
<p>We could consider a change so that error load is not triggered if the
only exclusions are for heights 3+D outside of w2.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Carrie Daymont, Robert Grundmeier, Jeffrey Miller, Diego Campos.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
