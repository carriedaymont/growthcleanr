<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Utilities for computing pediatric BMI percentiles, Z-scores, and related tools • growthcleanr</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Utilities for computing pediatric BMI percentiles, Z-scores, and related tools">
<meta property="og:description" content="growthcleanr">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">growthcleanr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.0.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="divider">
    </li>
<li class="dropdown-header">Getting started</li>
    <li>
      <a href="../articles/quickstart.html">Quickstart</a>
    </li>
    <li>
      <a href="../articles/installation.html">Installation</a>
    </li>
    <li>
      <a href="../articles/usage.html">Usage</a>
    </li>
    <li class="divider">
    </li>
<li class="dropdown-header">Advanced topics</li>
    <li>
      <a href="../articles/configuration.html">Configuration</a>
    </li>
    <li>
      <a href="../articles/output.html">Understanding growthcleanr output</a>
    </li>
    <li>
      <a href="../articles/adult-algorithm.html">Adult algorithm</a>
    </li>
    <li>
      <a href="../articles/utilities.html">Utilities for computing pediatric BMI percentiles, Z-scores, and related tools</a>
    </li>
    <li>
      <a href="../articles/large-data-sets.html">Working with large data sets</a>
    </li>
    <li>
      <a href="../articles/next-steps.html">Next steps</a>
    </li>
    <li>
      <a href="../articles/developer-guidelines.html">Developer guidelines</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/carriedaymont/growthcleanr" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Utilities for computing pediatric BMI
percentiles, Z-scores, and related tools</h1>
            
            <h4 data-toc-skip class="date">2022-11-03</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/carriedaymont/growthcleanr/blob/main/vignettes/utilities.Rmd" class="external-link"><code>vignettes/utilities.Rmd</code></a></small>
      <div class="hidden name"><code>utilities.Rmd</code></div>

    </div>

    
    
<p>The CDC provides a <a href="https://www.cdc.gov/nccdphp/dnpao/growthcharts/resources/sas.htm" class="external-link">SAS
macro for computing BMI percentiles and Z-scores</a>. The function
<code><a href="../reference/ext_bmiz.html">ext_bmiz()</a></code>, included in <code>growthcleanr</code>, provides
an equivalent feature. <code><a href="../reference/ext_bmiz.html">ext_bmiz()</a></code> calculates the sigma
(scale parameter for the half-normal distribution, extended BMI
percentile), extended BMIz, and the CDC LMS z-scores for weight, height,
and BMI. Note that for BMIs ≤ 95th percentile of the CDC growth charts,
the extended values for BMI are equal to the LMS values. The extended
values differ only for children who have a BMI &gt; 95th percentile.</p>
<p>The function assumes a variable ‘sex’ (coded as 1=boys / 2=girls) and
variables for age in months, weight (kg), height (cm), and BMI
(weight/ht2). Please be careful with age - the units should be months
and use the most accurate information available (e.g., 23.4928 months.
The extended BMIz is the inverse cumulative distribution function (CDF)
of the extended BMI percentile. If the extended percentile is very close
to 100, the <code>qnorm</code> function in R produces an infinite value.
The occurs only if the extended BMI percentile is &gt;
99.99999999999999. This occurs infrequently, such as a 48-month-old with
a BMI &gt; 39, and it is likely that these BMIs represent data entry
errors. For these cases, extended BMIz is set to 8.21, a value that is
slightly greater than the largest value that can be calculated.</p>
<div class="section level2">
<h2 id="converting-long-growthcleanr-data-to-wide-format-wbmi">Converting long growthcleanr data to wide format w/BMI<a class="anchor" aria-label="anchor" href="#converting-long-growthcleanr-data-to-wide-format-wbmi"></a>
</h2>
<p>Because <code><a href="../reference/ext_bmiz.html">ext_bmiz()</a></code> performs cross-sectional analysis of
BMI, observation data must be in a wide format, i.e. with height and
weight information on the same row. This is distinct from
<code><a href="../reference/cleangrowth.html">cleangrowth()</a></code>, which performs longitudinal analysis on all
observations for each subject, presented in a long format with one
observation per row. To facilitate use of both functions,
<code>growthcleanr</code> includes utility functions to transform data
used with <code><a href="../reference/cleangrowth.html">cleangrowth()</a></code> for use with
<code><a href="../reference/ext_bmiz.html">ext_bmiz()</a></code>. They are optimized to move data directly from
the output of <code><a href="../reference/cleangrowth.html">cleangrowth()</a></code> into input for
<code><a href="../reference/ext_bmiz.html">ext_bmiz()</a></code>, but have options to support independent use as
well.</p>
<p>Using the <code>syngrowth</code> example dataset, to convert the data
after it has been cleaned by <code><a href="../reference/cleangrowth.html">cleangrowth()</a></code> for use with
<code><a href="../reference/ext_bmiz.html">ext_bmiz()</a></code>, use <code><a href="../reference/longwide.html">longwide()</a></code> and
<code><a href="../reference/simple_bmi.html">simple_bmi()</a></code>:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Use the built-in utility function to convert the input observations to wide</span></span>
<span><span class="co"># format for BMI calculation</span></span>
<span><span class="va">cleaned_data_wide</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/longwide.html">longwide</a></span><span class="op">(</span><span class="va">cleaned_data</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Compute simple BMI values (adds column "bmi")</span></span>
<span><span class="va">cleaned_data_bmi</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simple_bmi.html">simple_bmi</a></span><span class="op">(</span><span class="va">cleaned_data_wide</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Compute Z-scores and percentiles</span></span>
<span><span class="va">cleaned_data_bmiz</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ext_bmiz.html">ext_bmiz</a></span><span class="op">(</span><span class="va">cleaned_data_bmi</span><span class="op">)</span></span></code></pre></div>
<p>Note that this assumes that <code>cleaned_data</code> has the same
structure as described in <a href="quickstart.html#data-preparation-1">Quickstart - Data
preparation</a>:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(cleaned_data)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">"id"</span>          <span class="st">"subjid"</span>      <span class="st">"sex"</span>         <span class="st">"agedays"</span>     <span class="st">"param"</span>       <span class="st">"measurement"</span> <span class="st">"gcr_result"</span></span></code></pre></div>
<p>The wide dataset <code>cleaned_data_wide</code> will include rows
with aligned height and weight measurements drawn from the observations
in <code>cleaned_data</code> marked by <code><a href="../reference/cleangrowth.html">cleangrowth()</a></code> for
inclusion. As such, it will be a shorter dataset (fewer rows) based on
fewer observations.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(cleaned_data)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">85728</span>     <span class="dv">7</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(cleaned_data_wide)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">26701</span>     <span class="dv">9</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(cleaned_data_wide)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>                                subjid    agey     agem sex   wt wt_id    ht ht_id  agedays</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> 002986c5<span class="sc">-</span>354d<span class="sc">-</span>bb9d<span class="sc">-</span>c180<span class="sc">-</span>4ce26813ca28 <span class="fl">56.0964</span> <span class="fl">673.1568</span>   <span class="dv">2</span> <span class="fl">71.7</span> <span class="dv">83331</span> <span class="fl">151.1</span> <span class="dv">83330</span> <span class="fl">20489.22</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> 002986c5<span class="sc">-</span>354d<span class="sc">-</span>bb9d<span class="sc">-</span>c180<span class="sc">-</span>4ce26813ca28 <span class="fl">57.1122</span> <span class="fl">685.3464</span>   <span class="dv">2</span> <span class="fl">73.2</span> <span class="dv">83333</span> <span class="fl">151.1</span> <span class="dv">83332</span> <span class="fl">20860.22</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span> 002986c5<span class="sc">-</span>354d<span class="sc">-</span>bb9d<span class="sc">-</span>c180<span class="sc">-</span>4ce26813ca28 <span class="fl">58.1279</span> <span class="fl">697.5348</span>   <span class="dv">2</span> <span class="fl">74.6</span> <span class="dv">83336</span> <span class="fl">151.1</span> <span class="dv">83335</span> <span class="fl">21231.22</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span> 002986c5<span class="sc">-</span>354d<span class="sc">-</span>bb9d<span class="sc">-</span>c180<span class="sc">-</span>4ce26813ca28 <span class="fl">59.1437</span> <span class="fl">709.7244</span>   <span class="dv">2</span> <span class="fl">72.8</span> <span class="dv">83338</span> <span class="fl">151.1</span> <span class="dv">83337</span> <span class="fl">21602.22</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span> 002986c5<span class="sc">-</span>354d<span class="sc">-</span>bb9d<span class="sc">-</span>c180<span class="sc">-</span>4ce26813ca28 <span class="fl">59.2012</span> <span class="fl">710.4144</span>   <span class="dv">2</span> <span class="fl">72.4</span> <span class="dv">83340</span> <span class="fl">151.1</span> <span class="dv">83339</span> <span class="fl">21623.22</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span> 002986c5<span class="sc">-</span>354d<span class="sc">-</span>bb9d<span class="sc">-</span>c180<span class="sc">-</span>4ce26813ca28 <span class="fl">60.1594</span> <span class="fl">721.9128</span>   <span class="dv">2</span> <span class="fl">69.4</span> <span class="dv">83343</span> <span class="fl">151.1</span> <span class="dv">83342</span> <span class="fl">21973.22</span></span></code></pre></div>
<p>In this example, the subject identifiers previously marked as
<code>subjid</code> are now in the <code>id</code> column; individual
identifiers for observations of a single parameter are not present.</p>
<p><code><a href="../reference/longwide.html">longwide()</a></code> can be called with name mapping parameters if
your input set uses different column names. For example, if
<code>my_cleaned_data</code> specifies age in days as <code>aged</code>
and parameter type as <code>type</code>, specify each, with quotes:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(my_cleaned_data)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>     id subjid sex    aged     type measurement                  gcr_result</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">:</span> <span class="dv">1510</span> <span class="dv">775155</span>   <span class="dv">0</span>     <span class="dv">889</span> HEIGHTCM       <span class="fl">84.90</span> Exclude<span class="sc">-</span>Extraneous<span class="sc">-</span>Same<span class="sc">-</span>Day</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span><span class="sc">:</span> <span class="dv">1511</span> <span class="dv">775155</span>   <span class="dv">0</span>     <span class="dv">889</span> HEIGHTCM       <span class="fl">89.06</span>                     Include</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span><span class="sc">:</span> <span class="dv">1518</span> <span class="dv">775155</span>   <span class="dv">0</span>     <span class="dv">889</span> WEIGHTKG       <span class="fl">13.10</span>                     Include</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span><span class="sc">:</span> <span class="dv">1512</span> <span class="dv">775155</span>   <span class="dv">0</span>    <span class="dv">1071</span> HEIGHTCM       <span class="fl">92.50</span>                     Include</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span><span class="sc">:</span> <span class="dv">1519</span> <span class="dv">775155</span>   <span class="dv">0</span>    <span class="dv">1071</span> WEIGHTKG       <span class="fl">14.70</span>                     Include</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span><span class="sc">:</span> <span class="dv">1513</span> <span class="dv">775155</span>   <span class="dv">0</span>    <span class="dv">1253</span> HEIGHTCM       <span class="fl">96.20</span>                     Include</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="fu">longwide</span>(my_cleaned_data, <span class="at">agedays =</span> <span class="st">"aged"</span>, <span class="at">param =</span> <span class="st">"type"</span>)</span></code></pre></div>
<p>By default, <code><a href="../reference/longwide.html">longwide()</a></code> will only transform records
flagged by <code><a href="../reference/cleangrowth.html">cleangrowth()</a></code> for inclusion. To include more
categories assigned by <code><a href="../reference/cleangrowth.html">cleangrowth()</a></code>, use the
<code>inclusion_types</code> option. For example, to include carried
forward values along with included records for the BMI calculation:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cleaned_data_wide_cf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/longwide.html">longwide</a></span><span class="op">(</span></span>
<span>  long_df <span class="op">=</span> <span class="va">cleaned_data</span>,</span>
<span>  inclusion_types<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Include"</span>, <span class="st">"Exclude-Carried-Forward"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>An additional option, <code>include_all</code>, set to
<code>FALSE</code> by default, will include all observations for
transformation.</p>
<p>See <code><a href="../reference/longwide.html">longwide()</a></code> for full details.</p>
<p>With wide data in hand, output taken directly from
<code><a href="../reference/longwide.html">longwide()</a></code> can have BMI added with
<code><a href="../reference/simple_bmi.html">simple_bmi()</a></code>, and then the output can be passed to
<code><a href="../reference/ext_bmiz.html">ext_bmiz()</a></code>, as shown in the simple example above.
Alternatively, you can provide a similarly formatted data frame directly
to <code><a href="../reference/ext_bmiz.html">ext_bmiz()</a></code>.</p>
</div>
<div class="section level2">
<h2 id="recoding-sex-values">Recoding sex values<a class="anchor" aria-label="anchor" href="#recoding-sex-values"></a>
</h2>
<p>Note that <code><a href="../reference/ext_bmiz.html">ext_bmiz()</a></code> expects the <code>sex</code>
variable to be coded as a numeric value of <code>1</code> (male) or
<code>2</code> (female). This difference from the
<code>growthcleanr</code> <a href="quickstart.html#data-preparation-1.">data preparation
specification</a> sustains compatibility with the CDC SAS macro. The
<code><a href="../reference/longwide.html">longwide()</a></code> function will handle this conversion given the
expected input values of <code>0</code> (male) or <code>1</code>
(female).</p>
<p>If you are using different input data for <code><a href="../reference/ext_bmiz.html">ext_bmiz()</a></code>,
ensure the <code>sex</code> variable in your data set is properly coded.
To do so, use <code><a href="../reference/recode_sex.html">recode_sex()</a></code>. For example, if you have data
in the PCORnet CDM format, and want to prepare it for
<code><a href="../reference/ext_bmiz.html">ext_bmiz()</a></code>:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/recode_sex.html">recode_sex</a></span><span class="op">(</span></span>
<span>  input_data <span class="op">=</span> <span class="va">cdm_formatted</span>,</span>
<span>  sourcecol <span class="op">=</span> <span class="st">"sex"</span>,</span>
<span>  sourcem <span class="op">=</span> <span class="st">"M"</span>,</span>
<span>  sourcef <span class="op">=</span> <span class="st">"F"</span>,</span>
<span>  targetm <span class="op">=</span> <span class="fl">1L</span>,</span>
<span>  targetf <span class="op">=</span> <span class="fl">2L</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><code><a href="../reference/recode_sex.html">recode_sex()</a></code> can also be used for other purposes, such
as recoding values in preparation for cleaning with
<code><a href="../reference/cleangrowth.html">cleangrowth()</a></code>, or transforming <code>growthcleanr</code>
output to match external specifications.</p>
</div>
<div class="section level2">
<h2 id="computing-bmi-percentiles-and-z-scores">Computing BMI percentiles and Z-scores<a class="anchor" aria-label="anchor" href="#computing-bmi-percentiles-and-z-scores"></a>
</h2>
<p>With data in wide format with BMI, and with sex variables properly
coded, <code><a href="../reference/ext_bmiz.html">ext_bmiz()</a></code> can be called:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>cleaned_data_bmiz <span class="ot">&lt;-</span> <span class="fu">ext_bmiz</span>(cleaned_data_bmi)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(cleaned_data_bmiz)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>           id    agey     agem      bmi sex   wt     ht agedays      age     bmi_l    bmi_m      bmi_s         waz    mod_waz        haz    mod_haz     bmiz  mod_bmiz</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">:</span> <span class="dv">1000287994</span> <span class="fl">10.0301</span> <span class="fl">120.3612</span> <span class="fl">22.84087</span>   <span class="dv">1</span> <span class="fl">40.1</span> <span class="fl">132.50</span>    <span class="dv">3661</span> <span class="fl">120.3612</span> <span class="sc">-</span><span class="fl">2.767881</span> <span class="fl">16.64016</span> <span class="fl">0.12002409</span>  <span class="fl">1.09852664</span>  <span class="fl">0.8417277</span> <span class="sc">-</span><span class="fl">0.9597118</span> <span class="sc">-</span><span class="fl">0.9717678</span> <span class="fl">1.757419</span> <span class="fl">1.5409867</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span><span class="sc">:</span> <span class="dv">1000287994</span> <span class="fl">11.0466</span> <span class="fl">132.5592</span> <span class="fl">22.84087</span>   <span class="dv">1</span> <span class="fl">40.1</span> <span class="fl">132.50</span>    <span class="dv">4032</span> <span class="fl">132.5592</span> <span class="sc">-</span><span class="fl">2.589785</span> <span class="fl">17.20379</span> <span class="fl">0.12676206</span>  <span class="fl">0.52509455</span>  <span class="fl">0.3595874</span> <span class="sc">-</span><span class="fl">1.6331550</span> <span class="sc">-</span><span class="fl">1.6408514</span> <span class="fl">1.584028</span> <span class="fl">1.2827508</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span><span class="sc">:</span> <span class="dv">1000287994</span> <span class="fl">12.0630</span> <span class="fl">144.7560</span> <span class="fl">18.35674</span>   <span class="dv">1</span> <span class="fl">40.1</span> <span class="fl">147.80</span>    <span class="dv">4403</span> <span class="fl">144.7560</span> <span class="sc">-</span><span class="fl">2.444694</span> <span class="fl">17.82828</span> <span class="fl">0.13146572</span> <span class="sc">-</span><span class="fl">0.08603109</span> <span class="sc">-</span><span class="fl">0.1155501</span> <span class="sc">-</span><span class="fl">0.2209003</span> <span class="sc">-</span><span class="fl">0.2267003</span> <span class="fl">0.214444</span> <span class="fl">0.1132188</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span><span class="sc">:</span> <span class="dv">1000287994</span> <span class="fl">13.0795</span> <span class="fl">156.9540</span> <span class="fl">24.12048</span>   <span class="dv">1</span> <span class="fl">57.8</span> <span class="fl">154.80</span>    <span class="dv">4774</span> <span class="fl">156.9540</span> <span class="sc">-</span><span class="fl">2.325379</span> <span class="fl">18.49734</span> <span class="fl">0.13420981</span>  <span class="fl">1.07298540</span>  <span class="fl">0.8792766</span> <span class="sc">-</span><span class="fl">0.2418916</span> <span class="sc">-</span><span class="fl">0.2436118</span> <span class="fl">1.475755</span> <span class="fl">1.1619424</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span><span class="sc">:</span> <span class="dv">1000287994</span> <span class="fl">14.0959</span> <span class="fl">169.1508</span> <span class="fl">25.03608</span>   <span class="dv">1</span> <span class="fl">66.6</span> <span class="fl">163.10</span>    <span class="dv">5145</span> <span class="fl">169.1508</span> <span class="sc">-</span><span class="fl">2.222102</span> <span class="fl">19.19533</span> <span class="fl">0.13527053</span>  <span class="fl">1.24466369</span>  <span class="fl">1.0724802</span> <span class="sc">-</span><span class="fl">0.1772860</span> <span class="sc">-</span><span class="fl">0.1713432</span> <span class="fl">1.483245</span> <span class="fl">1.1877586</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span><span class="sc">:</span> <span class="dv">1000287994</span>  <span class="fl">4.9479</span>  <span class="fl">59.3748</span> <span class="fl">16.88341</span>   <span class="dv">1</span> <span class="fl">19.5</span> <span class="fl">107.47</span>    <span class="dv">1806</span>  <span class="fl">59.3748</span> <span class="sc">-</span><span class="fl">2.533423</span> <span class="fl">15.43155</span> <span class="fl">0.07546578</span>  <span class="fl">0.48691152</span>  <span class="fl">0.3858433</span> <span class="sc">-</span><span class="fl">0.2363398</span> <span class="sc">-</span><span class="fl">0.2340109</span> <span class="fl">1.065532</span> <span class="fl">0.8981828</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>       bmip      p95      p97    bmip95       wp       hp obese sev_obese ext_bmiz ext_bmip    sigma</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">:</span> <span class="fl">96.05768</span> <span class="fl">22.14172</span> <span class="fl">23.71268</span> <span class="fl">103.15762</span> <span class="fl">86.40127</span> <span class="fl">16.86001</span>     <span class="dv">1</span>         <span class="dv">0</span> <span class="fl">1.705525</span> <span class="fl">95.59517</span> <span class="fl">4.668954</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span><span class="sc">:</span> <span class="fl">94.34063</span> <span class="fl">23.21872</span> <span class="fl">24.93200</span>  <span class="fl">98.37264</span> <span class="fl">70.02413</span>  <span class="fl">5.12182</span>     <span class="dv">0</span>         <span class="dv">0</span> <span class="fl">1.584028</span> <span class="fl">94.34063</span> <span class="fl">5.002164</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span><span class="sc">:</span> <span class="fl">58.48996</span> <span class="fl">24.25081</span> <span class="fl">26.05464</span>  <span class="fl">75.69536</span> <span class="fl">46.57209</span> <span class="fl">41.25850</span>     <span class="dv">0</span>         <span class="dv">0</span> <span class="fl">0.214444</span> <span class="fl">58.48996</span> <span class="fl">5.316539</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span><span class="sc">:</span> <span class="fl">92.99952</span> <span class="fl">25.21239</span> <span class="fl">27.05537</span>  <span class="fl">95.66916</span> <span class="fl">85.83612</span> <span class="fl">40.44321</span>     <span class="dv">0</span>         <span class="dv">0</span> <span class="fl">1.475755</span> <span class="fl">92.99952</span> <span class="fl">5.612141</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span><span class="sc">:</span> <span class="fl">93.09953</span> <span class="fl">26.09135</span> <span class="fl">27.92776</span>  <span class="fl">95.95547</span> <span class="fl">89.33723</span> <span class="fl">42.96419</span>     <span class="dv">0</span>         <span class="dv">0</span> <span class="fl">1.483245</span> <span class="fl">93.09953</span> <span class="fl">5.888911</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span><span class="sc">:</span> <span class="fl">85.66823</span> <span class="fl">17.91161</span> <span class="fl">18.39937</span>  <span class="fl">94.25957</span> <span class="fl">68.68395</span> <span class="fl">40.65845</span>     <span class="dv">0</span>         <span class="dv">0</span> <span class="fl">1.065532</span> <span class="fl">85.66823</span> <span class="fl">2.720945</span></span></code></pre></div>
<p>The output columns include:</p>
<table class="table">
<colgroup>
<col width="12%">
<col width="87%">
</colgroup>
<thead><tr class="header">
<th>variable</th>
<th>description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>waz, wp</td>
<td>LMS Weight-for-sex/age z-score and percentile</td>
</tr>
<tr class="even">
<td>haz, hp</td>
<td>LMS Height-for-sex/age z-score and percentile</td>
</tr>
<tr class="odd">
<td>bmiz, bmip</td>
<td>LMS BMI-for-sex/age z-score and percentile</td>
</tr>
<tr class="even">
<td>mod_waz, mod_haz, mod_bmi</td>
<td>Modified z-scores for identifying outliers (see the information in
the <a href="https://www.cdc.gov/nccdphp/dnpao/growthcharts/resources/sas.htm" class="external-link">CDC
SAS growth charts program website</a>)</td>
</tr>
<tr class="odd">
<td>bmip95</td>
<td>BMI expressed as a percentage of the 95th percentile. A value ≥ 120
is widely used as the cut point for severe obesity.</td>
</tr>
<tr class="even">
<td>sigma</td>
<td>Scale parameter of the half-normal distribution</td>
</tr>
<tr class="odd">
<td>ext_bmip</td>
<td>Extended BMI percentile</td>
</tr>
<tr class="even">
<td>ext_bmiz</td>
<td>Extended BMI z-score</td>
</tr>
</tbody>
</table>
<p>For convenience, these labels are available on the output of
<code><a href="../reference/ext_bmiz.html">ext_bmiz()</a></code>, e.g., when viewed in RStudio with
<code>View(cleaned_data_bmi)</code>.</p>
<p>Like <code><a href="../reference/longwide.html">longwide()</a></code>, <code><a href="../reference/ext_bmiz.html">ext_bmiz()</a></code> also includes
options for mapping alternate column names, for age, weight, height, and
BMI. The default column names are the same as the output from
<code><a href="../reference/longwide.html">longwide()</a></code> for convenience. If you have different column
names, specify the column names without quotes. For example, for a
dataset using “heightcm” and “weightkg” instead of “ht” and “wt”:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_cleaned_data_bmiz</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ext_bmiz.html">ext_bmiz</a></span><span class="op">(</span><span class="va">my_cleaned_data_wide_bmi</span>, ht <span class="op">=</span> <span class="va">heightcm</span>, wt <span class="op">=</span> <span class="va">weightkg</span><span class="op">)</span></span></code></pre></div>
<p>For <code><a href="../reference/ext_bmiz.html">ext_bmiz()</a></code>, use the most precise age in months
available. If an input dataset only has age in months as integer values,
by default <code><a href="../reference/ext_bmiz.html">ext_bmiz()</a></code> will automatically convert these to
double values and add <code>0.5</code> to account for the distribution
of actual ages over the range of days within a month. This is enabled
with the option <code>adjust.integer.age</code>, set to
<code>TRUE</code> by default. Specify <code>FALSE</code> to disable.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_cleaned_data_bmi</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ext_bmiz.html">ext_bmiz</a></span><span class="op">(</span><span class="va">my_cleaned_data_wide</span>, adjust.integer.age <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><code><a href="../reference/ext_bmiz.html">ext_bmiz()</a></code> uses reference data provided by the CDC,
included in the <code>growthcleanr</code> package as
<code>inst/extdata/CDCref_d.csv</code>. This file is automatically
loaded and used by default. If you are working with a different
reference dataset or developing the <code>growthcleanr</code> package,
specify an alternate path to this file with <code>ref.data.path</code>,
as for <code><a href="../reference/cleangrowth.html">cleangrowth()</a></code>.</p>
</div>
<div class="section level2">
<h2 id="related-tools">Related tools<a class="anchor" aria-label="anchor" href="#related-tools"></a>
</h2>
<p>The CDC provides a <a href="https://www.cdc.gov/nccdphp/dnpao/growthcharts/resources/sas.htm" class="external-link">SAS
Program for the 2000 CDC Growth Charts</a> which can also be used to
identify biologically implausible values using a different approach, as
also implemented for <code>growthcleanr</code> in the function
<code><a href="../reference/ext_bmiz.html">ext_bmiz()</a></code>, described above.</p>
<p><a href="https://github.com/mitre/GrowthViz" class="external-link">GrowthViz</a> provides
insights into how <code>growthcleanr</code> assesses data, packaged in a
Jupyter notebook. It ships with the same <code>syngrowth</code>
synthetic example dataset as <code>growthcleanr</code>, with cleaning
results included.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Daymont Carrie, Grundmeier Robert, Miller Jeffrey, Campos Diego.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
