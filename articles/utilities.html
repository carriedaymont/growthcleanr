<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Utilities for computing pediatric BMI percentiles, Z-scores, and related tools • growthcleanr</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Utilities for computing pediatric BMI percentiles, Z-scores, and related tools">
<meta property="og:description" content="growthcleanr">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">growthcleanr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="divider">
    </li>
<li class="dropdown-header">Getting started</li>
    <li>
      <a href="../articles/quickstart.html">Quickstart</a>
    </li>
    <li>
      <a href="../articles/installation.html">Installation</a>
    </li>
    <li>
      <a href="../articles/usage.html">Usage</a>
    </li>
    <li class="divider">
    </li>
<li class="dropdown-header">Advanced topics</li>
    <li>
      <a href="../articles/configuration.html">Configuration</a>
    </li>
    <li>
      <a href="../articles/output.html">Understanding growthcleanr output</a>
    </li>
    <li>
      <a href="../articles/adult-algorithm.html">Adult algorithm</a>
    </li>
    <li>
      <a href="../articles/utilities.html">Utilities for computing pediatric BMI percentiles, Z-scores, and related tools</a>
    </li>
    <li>
      <a href="../articles/large-data-sets.html">Working with large data sets</a>
    </li>
    <li>
      <a href="../articles/next-steps.html">Next steps</a>
    </li>
    <li>
      <a href="../articles/developer-guidelines.html">Developer guidelines</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/carriedaymont/growthcleanr" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Utilities for computing pediatric BMI
percentiles, Z-scores, and related tools</h1>
            
            <h4 data-toc-skip class="date">2023-02-03</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/carriedaymont/growthcleanr/blob/main/vignettes/utilities.Rmd" class="external-link"><code>vignettes/utilities.Rmd</code></a></small>
      <div class="hidden name"><code>utilities.Rmd</code></div>

    </div>

    
    
<p>The CDC provides a <a href="https://www.cdc.gov/nccdphp/dnpao/growthcharts/resources/sas.htm" class="external-link">SAS
macro for computing BMI percentiles and Z-scores</a>. The function
<code><a href="../reference/ext_bmiz.html">ext_bmiz()</a></code>, included in <code>growthcleanr</code>, provides
an equivalent feature. <code><a href="../reference/ext_bmiz.html">ext_bmiz()</a></code> calculates the sigma
(scale parameter for the half-normal distribution, extended BMI
percentile), extended BMIz, and the CDC LMS z-scores for weight, height,
and BMI. Note that for BMIs ≤ 95th percentile of the CDC growth charts,
the extended values for BMI are equal to the LMS values. The extended
values differ only for children who have a BMI &gt; 95th percentile.</p>
<p>The function assumes a variable ‘sex’ and variables for age in
months, weight (kg), height (cm), and BMI (weight/ht2). Please be
careful with age - the units should be months and use the most accurate
information available (e.g., 23.4928 months. The extended BMIz is the
inverse cumulative distribution function (CDF) of the extended BMI
percentile. If the extended percentile is very close to 100, the
<code>qnorm</code> function in R produces an infinite value. The occurs
only if the extended BMI percentile is &gt; 99.99999999999999. This
occurs infrequently, such as a 48-month-old with a BMI &gt; 39, and it
is likely that these BMIs represent data entry errors. For these cases,
extended BMIz is set to 8.21, a value that is slightly greater than the
largest value that can be calculated.</p>
<p>The <code><a href="../reference/longwide.html">longwide()</a></code> function provides a convenient way to
prepare data for use with <code><a href="../reference/ext_bmiz.html">ext_bmiz()</a></code>. The example in the
next section shows a potential workflow for taking the “long” (one
observation per row) data from <code><a href="../reference/cleangrowth.html">cleangrowth()</a></code> and converting
it to the “wide” (height and weight on one line) format required by
<code><a href="../reference/ext_bmiz.html">ext_bmiz()</a></code>. An additional function
<code><a href="../reference/recode_sex.html">recode_sex()</a></code> supports recoding coded values for
<code>sex</code> from one value set to another.</p>
<p>The CDC SAS macro was updated in December 2022, according to the
findings of <a href="https://dx.doi.org/10.15620/cdc:121711" class="external-link">this NCHS
report</a>. The <code><a href="../reference/ext_bmiz.html">ext_bmiz()</a></code> function has been updated to
match it as of growthcleanr v2.1.0.</p>
<div class="section level2">
<h2 id="converting-long-growthcleanr-data-to-wide-format-wbmi">Converting long growthcleanr data to wide format w/BMI<a class="anchor" aria-label="anchor" href="#converting-long-growthcleanr-data-to-wide-format-wbmi"></a>
</h2>
<p>Because <code><a href="../reference/ext_bmiz.html">ext_bmiz()</a></code> performs cross-sectional analysis of
BMI, observation data must be in a wide format, i.e. with height and
weight information on the same row. This is distinct from
<code><a href="../reference/cleangrowth.html">cleangrowth()</a></code>, which performs longitudinal analysis on all
observations for each subject, presented in a long format with one
observation per row. To facilitate use of both functions,
<code>growthcleanr</code> includes utility functions to transform data
used with <code><a href="../reference/cleangrowth.html">cleangrowth()</a></code> for use with
<code><a href="../reference/ext_bmiz.html">ext_bmiz()</a></code>. They are optimized to move data directly from
the output of <code><a href="../reference/cleangrowth.html">cleangrowth()</a></code> into input for
<code><a href="../reference/ext_bmiz.html">ext_bmiz()</a></code>, but have options to support independent use as
well.</p>
<p>Using the <code>syngrowth</code> example dataset, to convert the data
after it has been cleaned by <code><a href="../reference/cleangrowth.html">cleangrowth()</a></code> for use with
<code><a href="../reference/ext_bmiz.html">ext_bmiz()</a></code>, use <code><a href="../reference/longwide.html">longwide()</a></code> and
<code><a href="../reference/simple_bmi.html">simple_bmi()</a></code>:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Use the built-in utility function to convert the input observations to wide</span></span>
<span><span class="co"># format for BMI calculation</span></span>
<span><span class="va">cleaned_data_wide</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/longwide.html">longwide</a></span><span class="op">(</span><span class="va">cleaned_data</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Compute simple BMI values (adds column "bmi")</span></span>
<span><span class="va">cleaned_data_bmi</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simple_bmi.html">simple_bmi</a></span><span class="op">(</span><span class="va">cleaned_data_wide</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Compute Z-scores and percentiles</span></span>
<span><span class="va">cleaned_data_bmiz</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ext_bmiz.html">ext_bmiz</a></span><span class="op">(</span><span class="va">cleaned_data_bmi</span><span class="op">)</span></span></code></pre></div>
<p>Note that this assumes that <code>cleaned_data</code> has the same
structure as described in <a href="quickstart.html#data-preparation-1">Quickstart - Data
preparation</a>:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(cleaned_data)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">"id"</span>          <span class="st">"subjid"</span>      <span class="st">"sex"</span>         <span class="st">"agedays"</span>     <span class="st">"param"</span>       <span class="st">"measurement"</span> <span class="st">"gcr_result"</span></span></code></pre></div>
<p>The wide dataset <code>cleaned_data_wide</code> will include rows
with aligned height and weight measurements drawn from the observations
in <code>cleaned_data</code> marked by <code><a href="../reference/cleangrowth.html">cleangrowth()</a></code> for
inclusion. As such, it will be a shorter dataset (fewer rows) based on
fewer observations.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(cleaned_data)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">85728</span>     <span class="dv">7</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(cleaned_data_wide)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">26701</span>     <span class="dv">9</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(cleaned_data_wide)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>                                subjid    agey     agem sex   wt wt_id    ht ht_id  agedays</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> 002986c5<span class="sc">-</span>354d<span class="sc">-</span>bb9d<span class="sc">-</span>c180<span class="sc">-</span>4ce26813ca28 <span class="fl">56.0964</span> <span class="fl">673.1568</span>   <span class="dv">2</span> <span class="fl">71.7</span> <span class="dv">83331</span> <span class="fl">151.1</span> <span class="dv">83330</span> <span class="fl">20489.22</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> 002986c5<span class="sc">-</span>354d<span class="sc">-</span>bb9d<span class="sc">-</span>c180<span class="sc">-</span>4ce26813ca28 <span class="fl">57.1122</span> <span class="fl">685.3464</span>   <span class="dv">2</span> <span class="fl">73.2</span> <span class="dv">83333</span> <span class="fl">151.1</span> <span class="dv">83332</span> <span class="fl">20860.22</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span> 002986c5<span class="sc">-</span>354d<span class="sc">-</span>bb9d<span class="sc">-</span>c180<span class="sc">-</span>4ce26813ca28 <span class="fl">58.1279</span> <span class="fl">697.5348</span>   <span class="dv">2</span> <span class="fl">74.6</span> <span class="dv">83336</span> <span class="fl">151.1</span> <span class="dv">83335</span> <span class="fl">21231.22</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span> 002986c5<span class="sc">-</span>354d<span class="sc">-</span>bb9d<span class="sc">-</span>c180<span class="sc">-</span>4ce26813ca28 <span class="fl">59.1437</span> <span class="fl">709.7244</span>   <span class="dv">2</span> <span class="fl">72.8</span> <span class="dv">83338</span> <span class="fl">151.1</span> <span class="dv">83337</span> <span class="fl">21602.22</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span> 002986c5<span class="sc">-</span>354d<span class="sc">-</span>bb9d<span class="sc">-</span>c180<span class="sc">-</span>4ce26813ca28 <span class="fl">59.2012</span> <span class="fl">710.4144</span>   <span class="dv">2</span> <span class="fl">72.4</span> <span class="dv">83340</span> <span class="fl">151.1</span> <span class="dv">83339</span> <span class="fl">21623.22</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span> 002986c5<span class="sc">-</span>354d<span class="sc">-</span>bb9d<span class="sc">-</span>c180<span class="sc">-</span>4ce26813ca28 <span class="fl">60.1594</span> <span class="fl">721.9128</span>   <span class="dv">2</span> <span class="fl">69.4</span> <span class="dv">83343</span> <span class="fl">151.1</span> <span class="dv">83342</span> <span class="fl">21973.22</span></span></code></pre></div>
<p>In this example, the subject identifiers previously marked as
<code>subjid</code> are now in the <code>id</code> column; individual
identifiers for observations of a single parameter are not present.</p>
<p><code><a href="../reference/longwide.html">longwide()</a></code> can be called with name mapping parameters if
your input set uses different column names. For example, if
<code>my_cleaned_data</code> specifies age in days as <code>aged</code>
and parameter type as <code>type</code>, specify each, with quotes:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(my_cleaned_data)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>     id subjid sex    aged     type measurement                  gcr_result</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">:</span> <span class="dv">1510</span> <span class="dv">775155</span>   <span class="dv">0</span>     <span class="dv">889</span> HEIGHTCM       <span class="fl">84.90</span> Exclude<span class="sc">-</span>Extraneous<span class="sc">-</span>Same<span class="sc">-</span>Day</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span><span class="sc">:</span> <span class="dv">1511</span> <span class="dv">775155</span>   <span class="dv">0</span>     <span class="dv">889</span> HEIGHTCM       <span class="fl">89.06</span>                     Include</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span><span class="sc">:</span> <span class="dv">1518</span> <span class="dv">775155</span>   <span class="dv">0</span>     <span class="dv">889</span> WEIGHTKG       <span class="fl">13.10</span>                     Include</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span><span class="sc">:</span> <span class="dv">1512</span> <span class="dv">775155</span>   <span class="dv">0</span>    <span class="dv">1071</span> HEIGHTCM       <span class="fl">92.50</span>                     Include</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span><span class="sc">:</span> <span class="dv">1519</span> <span class="dv">775155</span>   <span class="dv">0</span>    <span class="dv">1071</span> WEIGHTKG       <span class="fl">14.70</span>                     Include</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span><span class="sc">:</span> <span class="dv">1513</span> <span class="dv">775155</span>   <span class="dv">0</span>    <span class="dv">1253</span> HEIGHTCM       <span class="fl">96.20</span>                     Include</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="fu">longwide</span>(my_cleaned_data, <span class="at">agedays =</span> <span class="st">"aged"</span>, <span class="at">param =</span> <span class="st">"type"</span>)</span></code></pre></div>
<p>By default, <code><a href="../reference/longwide.html">longwide()</a></code> will only transform records
flagged by <code><a href="../reference/cleangrowth.html">cleangrowth()</a></code> for inclusion. To include more
categories assigned by <code><a href="../reference/cleangrowth.html">cleangrowth()</a></code>, use the
<code>inclusion_types</code> option. For example, to include carried
forward values along with included records for the BMI calculation:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cleaned_data_wide_cf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/longwide.html">longwide</a></span><span class="op">(</span></span>
<span>  long_df <span class="op">=</span> <span class="va">cleaned_data</span>,</span>
<span>  inclusion_types<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Include"</span>, <span class="st">"Exclude-Carried-Forward"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Another option, <code>include_all</code>, set to <code>FALSE</code>
by default, will include all observations for transformation. Additional
options provide flexibility to preserve additional columns and unmatched
observation rows.</p>
<p>See <code><a href="../reference/longwide.html">longwide()</a></code> for full details.</p>
<p>With wide data in hand, output taken directly from
<code><a href="../reference/longwide.html">longwide()</a></code> can have BMI added with
<code><a href="../reference/simple_bmi.html">simple_bmi()</a></code>, and then the output can be passed to
<code><a href="../reference/ext_bmiz.html">ext_bmiz()</a></code>, as shown in the simple example above.
Alternatively, you can provide a similarly formatted data frame directly
to <code><a href="../reference/ext_bmiz.html">ext_bmiz()</a></code>.</p>
</div>
<div class="section level2">
<h2 id="recoding-sex-values">Recoding sex values<a class="anchor" aria-label="anchor" href="#recoding-sex-values"></a>
</h2>
<p>Note that <code><a href="../reference/ext_bmiz.html">ext_bmiz()</a></code> allows for the <code>sex</code>
variable to be coded using <a href="#computing-bmi-percentiles-and-z-scores">a range of possible
values</a>, but not the same <code>0</code> and <code>1</code> values as
<code><a href="../reference/cleangrowth.html">cleangrowth()</a></code>. This difference from the
<code>growthcleanr</code> <a href="quickstart.html#data-preparation-1.">data preparation
specification</a> sustains compatibility with the CDC SAS macro. The
<code><a href="../reference/longwide.html">longwide()</a></code> function will handle this conversion from
<code>growthcleanr</code>’s <code>0</code> (male) or <code>1</code>
(female), but not from other coded values.</p>
<p>If you are using input data with different value codes for
<code>sex</code> with <code><a href="../reference/ext_bmiz.html">ext_bmiz()</a></code>, use
<code><a href="../reference/recode_sex.html">recode_sex()</a></code> to ensure your values are recoded first. For
example, if you have data in the PCORnet CDM format (using
<code>M</code> and <code>F</code>), and want to prepare it for
<code><a href="../reference/ext_bmiz.html">ext_bmiz()</a></code>:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/recode_sex.html">recode_sex</a></span><span class="op">(</span></span>
<span>  input_data <span class="op">=</span> <span class="va">cdm_formatted</span>,</span>
<span>  sourcecol <span class="op">=</span> <span class="st">"sex"</span>,</span>
<span>  sourcem <span class="op">=</span> <span class="st">"M"</span>,</span>
<span>  sourcef <span class="op">=</span> <span class="st">"F"</span>,</span>
<span>  targetm <span class="op">=</span> <span class="fl">1L</span>,</span>
<span>  targetf <span class="op">=</span> <span class="fl">2L</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><code><a href="../reference/recode_sex.html">recode_sex()</a></code> can also be used for other purposes, such
as recoding values in preparation for cleaning with
<code><a href="../reference/cleangrowth.html">cleangrowth()</a></code>, or transforming <code>growthcleanr</code>
output to match external specifications.</p>
</div>
<div class="section level2">
<h2 id="computing-bmi-percentiles-and-z-scores">Computing BMI percentiles and Z-scores<a class="anchor" aria-label="anchor" href="#computing-bmi-percentiles-and-z-scores"></a>
</h2>
<p>With data in wide format with BMI, and with <code>sex</code> values
properly coded (as any of ‘1’, ‘b’, ‘B’, ‘Boys’, ‘m’, ‘M’, ‘male’, or
‘Male’ for male subjects and any of ‘2’, ‘g’, ‘G’, ‘Girls’, ‘f’, ‘F’,
‘female’, or ‘Female’ for female subjects), <code><a href="../reference/ext_bmiz.html">ext_bmiz()</a></code> can
be called:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>cleaned_data_bmiz <span class="ot">&lt;-</span> <span class="fu">ext_bmiz</span>(cleaned_data_bmi)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(cleaned_data_bmiz)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>                                 subjid    agey      age   sex    wt wt_id    ht ht_id agedays      bmi      bmiz</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>                                 <span class="sc">&lt;</span>char<span class="sc">&gt;</span>   <span class="er">&lt;</span>num<span class="sc">&gt;</span>    <span class="er">&lt;</span>num<span class="sc">&gt;</span> <span class="er">&lt;</span>int<span class="sc">&gt;</span> <span class="er">&lt;</span>num<span class="sc">&gt;</span> <span class="er">&lt;</span>int<span class="sc">&gt;</span> <span class="er">&lt;</span>num<span class="sc">&gt;</span> <span class="er">&lt;</span>int<span class="sc">&gt;</span>   <span class="er">&lt;</span>int<span class="sc">&gt;</span>    <span class="er">&lt;</span>num<span class="sc">&gt;</span>     <span class="er">&lt;</span>num<span class="sc">&gt;</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">:</span> 001aa16d<span class="sc">-</span>bf0e<span class="sc">-</span>a077<span class="sc">-</span>3b3d<span class="sc">-</span>5ab8b58545ad <span class="fl">10.0233</span> <span class="fl">120.2796</span>     <span class="dv">2</span>  <span class="fl">35.4</span>    <span class="dv">17</span> <span class="fl">141.6</span>    <span class="dv">15</span>    <span class="dv">3661</span> <span class="fl">17.65537</span> <span class="fl">0.3236612</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span><span class="sc">:</span> 001aa16d<span class="sc">-</span>bf0e<span class="sc">-</span>a077<span class="sc">-</span>3b3d<span class="sc">-</span>5ab8b58545ad <span class="fl">11.0390</span> <span class="fl">132.4680</span>     <span class="dv">2</span>  <span class="fl">39.2</span>    <span class="dv">19</span> <span class="fl">147.9</span>    <span class="dv">18</span>    <span class="dv">4032</span> <span class="fl">17.92048</span> <span class="fl">0.1734315</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span><span class="sc">:</span> 001aa16d<span class="sc">-</span>bf0e<span class="sc">-</span>a077<span class="sc">-</span>3b3d<span class="sc">-</span>5ab8b58545ad <span class="fl">12.0548</span> <span class="fl">144.6576</span>     <span class="dv">2</span>  <span class="fl">44.8</span>    <span class="dv">21</span> <span class="fl">155.1</span>    <span class="dv">20</span>    <span class="dv">4403</span> <span class="fl">18.62320</span> <span class="fl">0.1832443</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span><span class="sc">:</span> 001aa16d<span class="sc">-</span>bf0e<span class="sc">-</span>a077<span class="sc">-</span>3b3d<span class="sc">-</span>5ab8b58545ad <span class="fl">12.5914</span> <span class="fl">151.0968</span>     <span class="dv">2</span>  <span class="fl">47.8</span>    <span class="dv">23</span> <span class="fl">158.7</span>    <span class="dv">22</span>    <span class="dv">4599</span> <span class="fl">18.97903</span> <span class="fl">0.1829183</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span><span class="sc">:</span> 001aa16d<span class="sc">-</span>bf0e<span class="sc">-</span>a077<span class="sc">-</span>3b3d<span class="sc">-</span>5ab8b58545ad <span class="fl">13.0705</span> <span class="fl">156.8460</span>     <span class="dv">2</span>  <span class="fl">50.5</span>    <span class="dv">26</span> <span class="fl">160.8</span>    <span class="dv">24</span>    <span class="dv">4774</span> <span class="fl">19.53077</span> <span class="fl">0.2586449</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span><span class="sc">:</span> 001aa16d<span class="sc">-</span>bf0e<span class="sc">-</span>a077<span class="sc">-</span>3b3d<span class="sc">-</span>5ab8b58545ad  <span class="fl">3.9288</span>  <span class="fl">47.1456</span>     <span class="dv">2</span>  <span class="fl">16.6</span>     <span class="dv">2</span> <span class="fl">102.6</span>     <span class="dv">1</span>    <span class="dv">1435</span> <span class="fl">15.76933</span> <span class="fl">0.3453978</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>       bmip       waz       wp       haz       hp      p95      p97   bmip95   mod_bmiz   mod_waz   mod_haz</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>      <span class="sc">&lt;</span>num<span class="sc">&gt;</span>     <span class="er">&lt;</span>num<span class="sc">&gt;</span>    <span class="er">&lt;</span>num<span class="sc">&gt;</span>     <span class="er">&lt;</span>num<span class="sc">&gt;</span>    <span class="er">&lt;</span>num<span class="sc">&gt;</span>    <span class="er">&lt;</span>num<span class="sc">&gt;</span>    <span class="er">&lt;</span>num<span class="sc">&gt;</span>    <span class="er">&lt;</span>num<span class="sc">&gt;</span>      <span class="er">&lt;</span>num<span class="sc">&gt;</span>     <span class="er">&lt;</span>num<span class="sc">&gt;</span>     <span class="er">&lt;</span>num<span class="sc">&gt;</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">:</span> <span class="fl">62.69027</span> <span class="fl">0.3498817</span> <span class="fl">63.67862</span> <span class="fl">0.5140553</span> <span class="fl">69.63933</span> <span class="fl">22.96109</span> <span class="fl">24.57902</span> <span class="fl">76.89254</span> <span class="fl">0.18485501</span> <span class="fl">0.2399201</span> <span class="fl">0.5008944</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span><span class="sc">:</span> <span class="fl">56.88438</span> <span class="fl">0.2311645</span> <span class="fl">59.14065</span> <span class="fl">0.5002225</span> <span class="fl">69.15408</span> <span class="fl">24.13836</span> <span class="fl">25.90525</span> <span class="fl">74.24067</span> <span class="fl">0.09543668</span> <span class="fl">0.1556259</span> <span class="fl">0.4955022</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span><span class="sc">:</span> <span class="fl">57.26968</span> <span class="fl">0.3237374</span> <span class="fl">62.69316</span> <span class="fl">0.4803298</span> <span class="fl">68.45036</span> <span class="fl">25.26981</span> <span class="fl">27.17179</span> <span class="fl">73.69745</span> <span class="fl">0.10065274</span> <span class="fl">0.2201655</span> <span class="fl">0.4855100</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span><span class="sc">:</span> <span class="fl">57.25689</span> <span class="fl">0.3812700</span> <span class="fl">64.84986</span> <span class="fl">0.5153244</span> <span class="fl">69.68368</span> <span class="fl">25.83904</span> <span class="fl">27.80781</span> <span class="fl">73.45100</span> <span class="fl">0.10011666</span> <span class="fl">0.2596479</span> <span class="fl">0.5212281</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span><span class="sc">:</span> <span class="fl">60.20454</span> <span class="fl">0.4440465</span> <span class="fl">67.14955</span> <span class="fl">0.4849566</span> <span class="fl">68.61464</span> <span class="fl">26.32757</span> <span class="fl">28.35405</span> <span class="fl">74.18371</span> <span class="fl">0.14353771</span> <span class="fl">0.3024342</span> <span class="fl">0.4885546</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span><span class="sc">:</span> <span class="fl">63.51023</span> <span class="fl">0.4369963</span> <span class="fl">66.89430</span> <span class="fl">0.5348018</span> <span class="fl">70.36065</span> <span class="fl">18.02950</span> <span class="fl">18.60078</span> <span class="fl">87.46409</span> <span class="fl">0.24462581</span> <span class="fl">0.3332011</span> <span class="fl">0.5224816</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>      sigma original_bmip original_bmiz sev_obese obese</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>      <span class="sc">&lt;</span>num<span class="sc">&gt;</span>         <span class="er">&lt;</span>num<span class="sc">&gt;</span>         <span class="er">&lt;</span>num<span class="sc">&gt;</span>     <span class="er">&lt;</span>int<span class="sc">&gt;</span> <span class="er">&lt;</span>int<span class="sc">&gt;</span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">:</span> <span class="fl">4.443536</span>      <span class="fl">62.69027</span>     <span class="fl">0.3236612</span>         <span class="dv">0</span>     <span class="dv">0</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span><span class="sc">:</span> <span class="fl">4.797031</span>      <span class="fl">56.88438</span>     <span class="fl">0.1734315</span>         <span class="dv">0</span>     <span class="dv">0</span></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span><span class="sc">:</span> <span class="fl">5.148292</span>      <span class="fl">57.26968</span>     <span class="fl">0.1832443</span>         <span class="dv">0</span>     <span class="dv">0</span></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span><span class="sc">:</span> <span class="fl">5.332930</span>      <span class="fl">57.25689</span>     <span class="fl">0.1829183</span>         <span class="dv">0</span>     <span class="dv">0</span></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span><span class="sc">:</span> <span class="fl">5.497248</span>      <span class="fl">60.20454</span>     <span class="fl">0.2586449</span>         <span class="dv">0</span>     <span class="dv">0</span></span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span><span class="sc">:</span> <span class="fl">2.274792</span>      <span class="fl">63.51023</span>     <span class="fl">0.3453978</span>         <span class="dv">0</span>     <span class="dv">0</span></span></code></pre></div>
<p>The output columns include:</p>
<table class="table">
<colgroup>
<col width="11%">
<col width="88%">
</colgroup>
<thead><tr class="header">
<th>variable</th>
<th>description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>bmi</td>
<td>BMI</td>
</tr>
<tr class="even">
<td>bmiz, bmip</td>
<td>LMS / Extended z-score and percentile</td>
</tr>
<tr class="odd">
<td>waz, wp</td>
<td>LMS Weight-for-sex/age z-score and percentile</td>
</tr>
<tr class="even">
<td>haz, hp</td>
<td>LMS Height-for-sex/age z-score and percentile</td>
</tr>
<tr class="odd">
<td>p95, p97</td>
<td>95th and 97th percentile of BMI in growth charts</td>
</tr>
<tr class="even">
<td>bmip95</td>
<td>BMI expressed as a percentage of the 95th percentile. A value ≥ 120
is widely used as the cut point for severe obesity.</td>
</tr>
<tr class="odd">
<td>mod_bmiz, mod_waz, mod_haz</td>
<td>Modified BMI-for-age, Weight-for-age, and Height-for-age z-scores
for identifying outliers (see the information in the <a href="https://www.cdc.gov/nccdphp/dnpao/growthcharts/resources/sas.htm" class="external-link">CDC
SAS growth charts program website</a>)</td>
</tr>
<tr class="even">
<td>sigma</td>
<td>Scale parameter for half-normal distribution</td>
</tr>
<tr class="odd">
<td>original_bmiz, original_bmip</td>
<td>LMS BMI-for-sex/age z-score and percentile</td>
</tr>
<tr class="even">
<td>sev_obese</td>
<td>BMI &gt;= 120% of 95th percentile (0/1)</td>
</tr>
<tr class="odd">
<td>obese</td>
<td>BMI &gt;= 95th percentile (0/1)</td>
</tr>
</tbody>
</table>
<p>For convenience, these labels are available on the output of
<code><a href="../reference/ext_bmiz.html">ext_bmiz()</a></code>, e.g., when viewed in RStudio with
<code>View(cleaned_data_bmi)</code>.</p>
<p>Like <code><a href="../reference/longwide.html">longwide()</a></code>, <code><a href="../reference/ext_bmiz.html">ext_bmiz()</a></code> also includes
options for mapping alternate column names, for age, weight, height, and
BMI. The default column names are the same as the output from
<code><a href="../reference/longwide.html">longwide()</a></code> for convenience. If you have different column
names, specify the column names without quotes. For example, for a
dataset using “heightcm” and “weightkg” instead of “ht” and “wt”:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_cleaned_data_bmiz</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ext_bmiz.html">ext_bmiz</a></span><span class="op">(</span><span class="va">my_cleaned_data_wide_bmi</span>, ht <span class="op">=</span> <span class="va">heightcm</span>, wt <span class="op">=</span> <span class="va">weightkg</span><span class="op">)</span></span></code></pre></div>
<p>For <code><a href="../reference/ext_bmiz.html">ext_bmiz()</a></code>, use the most precise age in months
available. If an input dataset only has age in months as integer values,
by default <code><a href="../reference/ext_bmiz.html">ext_bmiz()</a></code> will automatically convert these to
double values and add <code>0.5</code> to account for the distribution
of actual ages over the range of days within a month. This is enabled
with the option <code>adjust.integer.age</code>, set to
<code>TRUE</code> by default. Specify <code>FALSE</code> to disable.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_cleaned_data_bmi</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ext_bmiz.html">ext_bmiz</a></span><span class="op">(</span><span class="va">my_cleaned_data_wide</span>, adjust.integer.age <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><code><a href="../reference/ext_bmiz.html">ext_bmiz()</a></code> uses reference data provided by the CDC,
included in the <code>growthcleanr</code> package as
<code>inst/extdata/CDCref_d.csv</code>. This file is automatically
loaded and used by default. If you are working with a different
reference dataset or developing the <code>growthcleanr</code> package,
specify an alternate path to this file with <code>ref.data.path</code>,
as for <code><a href="../reference/cleangrowth.html">cleangrowth()</a></code>.</p>
</div>
<div class="section level2">
<h2 id="related-tools">Related tools<a class="anchor" aria-label="anchor" href="#related-tools"></a>
</h2>
<p>The CDC provides a <a href="https://www.cdc.gov/nccdphp/dnpao/growthcharts/resources/sas.htm" class="external-link">SAS
Program for the 2000 CDC Growth Charts</a> which can also be used to
identify biologically implausible values using a different approach, as
also implemented for <code>growthcleanr</code> in the function
<code><a href="../reference/ext_bmiz.html">ext_bmiz()</a></code>, described above. The SAS program was updated in
December, 2022, according to the findings of <a href="https://dx.doi.org/10.15620/cdc:121711" class="external-link">this NCHS report</a>, and
<code><a href="../reference/ext_bmiz.html">ext_bmiz()</a></code> has been updated to match it as of growthcleanr
v2.1.0.</p>
<p><a href="https://github.com/mitre/GrowthViz" class="external-link">GrowthViz</a> provides
insights into how <code>growthcleanr</code> assesses data, packaged in a
Jupyter notebook. It ships with the same <code>syngrowth</code>
synthetic example dataset as <code>growthcleanr</code>, with cleaning
results included.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Daymont Carrie, Grundmeier Robert, Miller Jeffrey, Campos Diego.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
